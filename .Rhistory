mod2 <- gamlss(y~x1, sigma.fo=~x2, nu.fo=~x3,
family=BER, data=datos,
control=gamlss.control(n.cyc=500, trace=TRUE))
datos <- gendat(n=500)
mod2 <- gamlss(y~x1, sigma.fo=~x2, nu.fo=~x3,
family=BER, data=datos,
control=gamlss.control(n.cyc=500, trace=TRUE))
datos <- gendat(n=500)
mod2 <- gamlss(y~x1, sigma.fo=~x2, nu.fo=~x3,
family=BER, data=datos,
control=gamlss.control(n.cyc=500, trace=TRUE))
datos <- gendat(n=500)
mod2 <- gamlss(y~x1, sigma.fo=~x2, nu.fo=~x3,
family=BER, data=datos,
control=gamlss.control(n.cyc=500, trace=TRUE))
datos <- gendat(n=500)
mod2 <- gamlss(y~x1, sigma.fo=~x2, nu.fo=~x3,
family=BER, data=datos,
control=gamlss.control(n.cyc=500, trace=TRUE))
datos <- gendat(n=500)
mod2 <- gamlss(y~x1, sigma.fo=~x2, nu.fo=~x3,
family=BER, data=datos,
control=gamlss.control(n.cyc=500, trace=TRUE))
datos <- gendat(n=500)
mod2 <- gamlss(y~x1, sigma.fo=~x2, nu.fo=~x3,
family=BER, data=datos,
control=gamlss.control(n.cyc=500, trace=TRUE))
datos <- gendat(n=500)
mod2 <- gamlss(y~x1, sigma.fo=~x2, nu.fo=~x3,
family=BER, data=datos,
control=gamlss.control(n.cyc=500, trace=TRUE))
datos <- gendat(n=500)
mod2 <- gamlss(y~x1, sigma.fo=~x2, nu.fo=~x3,
family=BER, data=datos,
control=gamlss.control(n.cyc=500, trace=TRUE))
datos <- gendat(n=500)
mod2 <- gamlss(y~x1, sigma.fo=~x2, nu.fo=~x3,
family=BER, data=datos,
control=gamlss.control(n.cyc=500, trace=TRUE))
datos <- gendat(n=500)
mod2 <- gamlss(y~x1, sigma.fo=~x2, nu.fo=~x3,
family=BER, data=datos,
control=gamlss.control(n.cyc=500, trace=TRUE))
datos <- gendat(n=500)
mod2 <- gamlss(y~x1, sigma.fo=~x2, nu.fo=~x3,
family=BER, data=datos,
control=gamlss.control(n.cyc=500, trace=TRUE))
datos <- gendat(n=500)
mod2 <- gamlss(y~x1, sigma.fo=~x2, nu.fo=~x3,
family=BER, data=datos,
control=gamlss.control(n.cyc=500, trace=TRUE))
# A function to simulate a data set with Y ~ BER
gendat <- function(n) {
x1 <- runif(n, min=0.4, max=0.6)
x2 <- runif(n, min=0.4, max=0.6)
x3 <- runif(n, min=0.4, max=0.6)
mu    <- inv_logit(-0.5 + 1*x1)
sigma <- exp(-1 + 4.8*x2)
nu    <- inv_logit(-1 + 0.5*x3)
y <- rBER(n=n, mu=mu, sigma=sigma, nu=nu)
data.frame(y=y, x1=x1, x2=x2, x3=x3)
}
datos <- gendat(n=500)
mod2 <- gamlss(y~x1, sigma.fo=~x2, nu.fo=~x3,
family=BER, data=datos,
control=gamlss.control(n.cyc=500, trace=TRUE))
summary(mod2)
datos <- gendat(n=500)
mod2 <- gamlss(y~x1, sigma.fo=~x2, nu.fo=~x3,
family=BER, data=datos,
control=gamlss.control(n.cyc=500, trace=TRUE))
summary(mod2)
# Example 1
# Generating some random values with
# known mu and sigma
y <- rBER2(n=500, mu=0.5, sigma=10, nu=0.1)
# Fitting the model
library(gamlss)
mod1 <- gamlss(y~1, family=BER2,
control=gamlss.control(n.cyc=500, trace=FALSE))
# Extracting the fitted values for mu, sigma and nu
# using the inverse link function
inv_logit <- function(x) 1/(1 + exp(-x))
inv_logit(coef(mod1, what="mu"))
exp(coef(mod1, what="sigma"))
inv_logit(coef(mod1, what="nu"))
res <- histDist(y, family=BER2)
res$mu
res$sigma
res$nu
y <- rBER2(n=500, mu=0.5, sigma=10, nu=0.1)
# Fitting the model
library(gamlss)
mod1 <- gamlss(y~1, family=BER2,
control=gamlss.control(n.cyc=500, trace=FALSE))
# Extracting the fitted values for mu, sigma and nu
# using the inverse link function
inv_logit <- function(x) 1/(1 + exp(-x))
inv_logit(coef(mod1, what="mu"))
exp(coef(mod1, what="sigma"))
inv_logit(coef(mod1, what="nu"))
res <- histDist(y, family=BER2)
res$mu
res$sigma
res$nu
y <- rBER2(n=500, mu=0.5, sigma=10, nu=0.1)
# Fitting the model
library(gamlss)
mod1 <- gamlss(y~1, family=BER2,
control=gamlss.control(n.cyc=500, trace=FALSE))
# Extracting the fitted values for mu, sigma and nu
# using the inverse link function
inv_logit <- function(x) 1/(1 + exp(-x))
inv_logit(coef(mod1, what="mu"))
exp(coef(mod1, what="sigma"))
inv_logit(coef(mod1, what="nu"))
res <- histDist(y, family=BER2)
res$mu
res$sigma
res$nu
y <- rBER2(n=500, mu=0.5, sigma=10, nu=0.1)
# Fitting the model
library(gamlss)
mod1 <- gamlss(y~1, family=BER2,
control=gamlss.control(n.cyc=500, trace=FALSE))
# Extracting the fitted values for mu, sigma and nu
# using the inverse link function
inv_logit <- function(x) 1/(1 + exp(-x))
inv_logit(coef(mod1, what="mu"))
exp(coef(mod1, what="sigma"))
inv_logit(coef(mod1, what="nu"))
res <- histDist(y, family=BER2)
res$mu
res$sigma
res$nu
y <- rBER2(n=500, mu=0.5, sigma=10, nu=0.1)
# Fitting the model
library(gamlss)
mod1 <- gamlss(y~1, family=BER2,
control=gamlss.control(n.cyc=500, trace=FALSE))
# Extracting the fitted values for mu, sigma and nu
# using the inverse link function
inv_logit <- function(x) 1/(1 + exp(-x))
inv_logit(coef(mod1, what="mu"))
exp(coef(mod1, what="sigma"))
inv_logit(coef(mod1, what="nu"))
res <- histDist(y, family=BER2)
res$mu
res$sigma
res$nu
y <- rBER2(n=500, mu=0.5, sigma=100, nu=0.1)
# Fitting the model
library(gamlss)
mod1 <- gamlss(y~1, family=BER2,
control=gamlss.control(n.cyc=500, trace=FALSE))
# Extracting the fitted values for mu, sigma and nu
# using the inverse link function
inv_logit <- function(x) 1/(1 + exp(-x))
inv_logit(coef(mod1, what="mu"))
exp(coef(mod1, what="sigma"))
inv_logit(coef(mod1, what="nu"))
res <- histDist(y, family=BER2)
res$mu
res$sigma
res$nu
y <- rBER2(n=500, mu=0.5, sigma=100, nu=0.1)
# Fitting the model
library(gamlss)
mod1 <- gamlss(y~1, family=BER2,
control=gamlss.control(n.cyc=500, trace=FALSE))
# Extracting the fitted values for mu, sigma and nu
# using the inverse link function
inv_logit <- function(x) 1/(1 + exp(-x))
inv_logit(coef(mod1, what="mu"))
exp(coef(mod1, what="sigma"))
inv_logit(coef(mod1, what="nu"))
res <- histDist(y, family=BER2)
res$mu
res$sigma
res$nu
y <- rBER2(n=500, mu=0.5, sigma=7, nu=0.1)
# Fitting the model
library(gamlss)
mod1 <- gamlss(y~1, family=BER2,
control=gamlss.control(n.cyc=500, trace=FALSE))
# Extracting the fitted values for mu, sigma and nu
# using the inverse link function
inv_logit <- function(x) 1/(1 + exp(-x))
inv_logit(coef(mod1, what="mu"))
exp(coef(mod1, what="sigma"))
inv_logit(coef(mod1, what="nu"))
res <- histDist(y, family=BER2)
res$mu
res$sigma
res$nu
y <- rBER2(n=500, mu=0.5, sigma=7, nu=0.1)
# Fitting the model
library(gamlss)
mod1 <- gamlss(y~1, family=BER2,
control=gamlss.control(n.cyc=500, trace=FALSE))
# Extracting the fitted values for mu, sigma and nu
# using the inverse link function
inv_logit <- function(x) 1/(1 + exp(-x))
inv_logit(coef(mod1, what="mu"))
exp(coef(mod1, what="sigma"))
inv_logit(coef(mod1, what="nu"))
res <- histDist(y, family=BER2)
res$mu
res$sigma
res$nu
y <- rBER2(n=500, mu=0.5, sigma=7, nu=0.1)
# Fitting the model
library(gamlss)
mod1 <- gamlss(y~1, family=BER2,
control=gamlss.control(n.cyc=500, trace=FALSE))
# Extracting the fitted values for mu, sigma and nu
# using the inverse link function
inv_logit <- function(x) 1/(1 + exp(-x))
inv_logit(coef(mod1, what="mu"))
exp(coef(mod1, what="sigma"))
inv_logit(coef(mod1, what="nu"))
res <- histDist(y, family=BER2)
res$mu
res$sigma
res$nu
# Example 1
# Generating some random values with
# known mu and sigma
y <- rBER2(n=500, mu=0.5, sigma=7, nu=0.9)
# Fitting the model
library(gamlss)
mod1 <- gamlss(y~1, family=BER2,
control=gamlss.control(n.cyc=500, trace=FALSE))
# Extracting the fitted values for mu, sigma and nu
# using the inverse link function
inv_logit <- function(x) 1/(1 + exp(-x))
inv_logit(coef(mod1, what="mu"))
exp(coef(mod1, what="sigma"))
inv_logit(coef(mod1, what="nu"))
res <- histDist(y, family=BER2)
res$mu
res$sigma
res$nu
# Example 1
# Generating some random values with
# known mu and sigma
y <- rBER2(n=500, mu=0.5, sigma=7, nu=0.999)
# Fitting the model
library(gamlss)
mod1 <- gamlss(y~1, family=BER2,
control=gamlss.control(n.cyc=500, trace=FALSE))
# Extracting the fitted values for mu, sigma and nu
# using the inverse link function
inv_logit <- function(x) 1/(1 + exp(-x))
inv_logit(coef(mod1, what="mu"))
exp(coef(mod1, what="sigma"))
inv_logit(coef(mod1, what="nu"))
res <- histDist(y, family=BER2)
res$mu
res$sigma
res$nu
curve(dBER2(x, mu=0.5, sigma=7, nu=0.999))
curve(dBER2(x, mu=0.5, sigma=7, nu=0.1))
curve(dBER2(x, mu=0.5, sigma=7, nu=0.5))
curve(dBER2(x, mu=0.3, sigma=7, nu=0.5))
curve(dBER2(x, mu=0.3, sigma=70, nu=0.5))
curve(dBER2(x, mu=0.3, sigma=0.2, nu=0.5))
# Example 1
# Generating some random values with
# known mu and sigma
y <- rBER2(n=500, mu=0.3, sigma=0.2, nu=0.5)
# Fitting the model
library(gamlss)
mod1 <- gamlss(y~1, family=BER2,
control=gamlss.control(n.cyc=500, trace=FALSE))
# Example 1
# Generating some random values with
# known mu and sigma
y <- rBER2(n=500, mu=0.3, sigma=0.2, nu=0.5)
# Fitting the model
library(gamlss)
mod1 <- gamlss(y~1, family=BER2,
control=gamlss.control(n.cyc=500, trace=FALSE))
# Extracting the fitted values for mu, sigma and nu
# using the inverse link function
inv_logit <- function(x) 1/(1 + exp(-x))
inv_logit(coef(mod1, what="mu"))
exp(coef(mod1, what="sigma"))
inv_logit(coef(mod1, what="nu"))
res <- histDist(y, family=BER2)
# Example 1
# Generating some random values with
# known mu and sigma
y <- rBER2(n=500, mu=0.5, sigma=7, nu=0.999)
# Fitting the model
library(gamlss)
mod1 <- gamlss(y~1, family=BER2,
control=gamlss.control(n.cyc=500, trace=FALSE))
# Extracting the fitted values for mu, sigma and nu
# using the inverse link function
inv_logit <- function(x) 1/(1 + exp(-x))
inv_logit(coef(mod1, what="mu"))
exp(coef(mod1, what="sigma"))
inv_logit(coef(mod1, what="nu"))
res <- histDist(y, family=BER2)
res$mu
res$sigma
res$nu
# A function to simulate a data set with Y ~ BER2
gendat <- function(n) {
x1 <- runif(n, min=0.4, max=0.6)
x2 <- runif(n, min=0.4, max=0.6)
x3 <- runif(n, min=0.4, max=0.6)
mu    <- inv_logit(-0.5 + 1*x1)
sigma <- exp(-1 + 4.8*x2)
nu    <- inv_logit(-1 + 0.5*x3)
y <- rBER2(n=n, mu=mu, sigma=sigma, nu=nu)
data.frame(y=y, x1=x1, x2=x2, x3=x3)
}
datos <- gendat(n=5000)
mod2 <- gamlss(y~x1, sigma.fo=~x2, nu.fo=~x3,
family=BER2, data=datos,
control=gamlss.control(n.cyc=500, trace=TRUE))
summary(mod2)
curve(dBER2(x, mu=0.5, sigma=7, nu=0.999))
curve(dBER2(x, mu=0.5, sigma=7, nu=0.999),
ylim=c(0, 1))
# Example 1
# Generating some random values with
# known mu and sigma
y <- rBER2(n=500, mu=0.5, sigma=7, nu=0.999)
mod1 <- gamlss(y~1, family=BER2,
control=gamlss.control(n.cyc=500, trace=FALSE))
# Extracting the fitted values for mu, sigma and nu
# using the inverse link function
inv_logit <- function(x) 1/(1 + exp(-x))
inv_logit(coef(mod1, what="mu"))
exp(coef(mod1, what="sigma"))
inv_logit(coef(mod1, what="nu"))
res <- histDist(y, family=BER2)
res$mu
res$sigma
res$nu
devtools::load_all()
devtools::document()
devtools::install()
devtools::load_all()
devtools::document()
devtools::install()
pkgdown::build_site()
devtools::load_all()
devtools::document()
devtools::install()
pkgdown::build_site()
devtools::load_all()
devtools::document()
library(gamlss)
data1 <- c(0.19, 0.20, 0.20, 0.27, 0.30,
0.37, 0.30, 0.25, 0.23, 0.23,
0.26, 0.23, 0.19, 0.21, 0.20,
0.22, 0.21, 0.25, 0.25, 0.19)
mod3 <- gamlss(data1 ~ 1, family= UMB, mu.link= "log",
control= gamlss.control(n.cyc= 5000, trace= FALSE))
# Extracting the fitted values for mu
# using the inverse link function
exp(coef(mod3, what="mu"))
summary(mod3)
mod3 <- gamlss(data1 ~ 1, family= UMB)
# Extraction of the log likelihood
logLik(mod3)
data2 <- c(0.22, 0.20, 0.25, 0.15, 0.38,
0.18, 0.52, 0.27, 0.27, 0.27,
0.13, 0.15, 0.24, 0.37, 0.20)
mod4 <- gamlss(data2 ~ 1, family= UMB)
# Extracting the fitted values for mu
# using the inverse link function
exp(coef(mod4, what="mu"))
# Extraction of the log likelihood
logLik(mod4)
# Replicating figure 5 from Bicer et al. (2024)
# Hist and estimated pdf of Data-I and Data-II
mu1 <- 0.8452875
mu2 <- 0.8593051
par(mfrow = c(1, 2))
# Data-I
hist(data1, freq = FALSE,
xlim = c(0, 1.0), ylim = c(0, 10),
main = "Histogram of Data-I",
xlab = "y", ylab = "f(y)",
col = "burlywood1",
border = "darkgoldenrod4")
# Data-I
hist(data1, freq = FALSE,
xlim = c(0, 1.0), ylim = c(0, 10),
main = "Histogram of Data-I",
xlab = "y", ylab = "f(y)",
col = "burlywood1",
border = "darkgoldenrod4")
curve(dUMB(x, mu = mu1), add = TRUE,
col = "blue", lwd = 2)
legend("topright", legend = c("UMB"),
col = c("blue"), lwd = 2, bty = "n")
# Data-II
hist(data2, freq = FALSE,
xlim = c(0, 1.0), ylim = c(0, 6),
main = "Histogram of Data-II",
xlab = "y", ylab = "f(y)",
col = "burlywood1",
border = "darkgoldenrod4")
curve(dUMB(x, mu = mu2), add = TRUE,
col = "blue", lwd = 2)
legend("topright",
legend = c("UMB"),
col = c("blue"),
lwd = 2,
bty = "n")
par(mfrow = c(1, 1))
data3 <- c(0.048, 0.013, 0.040, 0.082, 0.073, 0.732, 0.302,
0.728, 0.305, 0.322,  0.045, 0.261, 0.192,
0.357, 0.022, 0.143, 0.208, 0.104, 0.330, 0.453,
0.135, 0.114, 0.049, 0.011, 0.008, 0.037, 0.034,
0.015, 0.028, 0.069, 0.029)
mod5 <- gamlss(data3 ~ 1, family= UMB)
# Extracting the fitted values for mu
# using the inverse link function
exp(coef(mod5, what="mu"))
# Extraction of the log likelihood
logLik(mod5)
data4 <- c(0.16, 0.19, 0.24, 0.25, 0.30, 0.41, 0.40,
0.33, 0.23, 0.27, 0.30, 0.32, 0.26, 0.25,
0.22, 0.22, 0.18, 0.18, 0.20, 0.23)
mod6 <- gamlss(data4 ~ 1, family= UMB)
# Extracting the fitted values for mu
# using the inverse link function
exp(coef(mod6, what="mu"))
# Extraction of the log likelihood
logLik(mod6)
# Replicating figure 6 from Bicer et al. (2024)
# Hist and estimated pdf of Data-III and Data-IV
mu3 <- 1.582003
mu4 <- 0.8161202
par(mfrow = c(1, 2))
# Data-III
hist(data3, freq = FALSE,
xlim = c(0, 1.0), ylim = c(0, 10),
main = "Histogram of Data-III",
xlab = "y", ylab = "f(y)",
col = "burlywood1",
border = "darkgoldenrod4")
curve(dUMB(x, mu = mu3), add = TRUE,
col = "blue", lwd = 2)
legend("topright", legend = c("UMB"),
col = c("blue"), lwd = 2, bty = "n")
# Data-IV
hist(data4, freq = FALSE,
xlim = c(0, 1.0), ylim = c(0, 6),
main = "Histogram of Data-IV",
xlab = "y", ylab = "f(y)",
col = "burlywood1",
border = "darkgoldenrod4")
curve(dUMB(x, mu = mu4), add = TRUE,
col = "blue", lwd = 2)
legend("topright",
legend = c("UMB"),
col = c("blue"),
lwd = 2,
bty = "n")
par(mfrow = c(1, 1))
devtools::load_all()
devtools::document()
devtools::install()
# Example 1
# Generating some random values with
# known mu
y <- rUMB(n=300, mu=0.5)
# Fitting the model
library(gamlss)
devtools::load_all()
devtools::document()
# Example 1
# Generating some random values with
# known mu
y <- rUMB(n=300, mu=0.5)
# Fitting the model
library(gamlss)
mod1 <- gamlss(y~1, family=UMB)
# Extracting the fitted values for mu
# using the inverse link function
exp(coef(mod1, what="mu"))
# A function to simulate a data set with Y ~ UMB
gendat <- function(n) {
x1 <- runif(n)
mu <- exp(-0.5 + 1 * x1)
y <- rUMB(n=n, mu=mu)
data.frame(y=y, x1=x1)
}
datos <- gendat(n=300)
mod2 <- gamlss(y~x1,
family=UMB, data=datos,
control=gamlss.control(n.cyc=500, trace=TRUE))
summary(mod2)
devtools::load_all()
devtools::document()
devtools::install()
3
pkgdown::build_site()
exp(-99999)
exp(-Inf)
devtools::load_all()
devtools::document()
devtools::install()
pkgdown::build_site()
